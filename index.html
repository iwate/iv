<!DOCTYPE html>
<html>
<head>
  <title>Image Viewer</title>
  <style>
    html,body {
      width: 100%;
      height: 100%;
      offset: 0;
      margin: 0;
      background: #111;
    }
  </style>
</head>
<body>
  <canvas id="canvas" ></canvas>
  
  <script>
    const width = window.innerWidth;
    const height = window.innerHeight;
    
    const params = location.search.startsWith('?') ? Object.fromEntries(location.search.slice(1).split('&').map(str => str.split('='))) : {};
    
    const canvas = document.getElementById('canvas');
    
    const ctx = canvas.getContext('2d');
    
    ctx.canvas.width  = width;
    ctx.canvas.height = height;

    const image = new Image();

    image.src = decodeURIComponent(params.src);

    let x = 0, y = 0, w = width, h = height;
    
    image.onload = () => {
        const aspect = image.width / image.height;
        w = aspect * height;
        x = (width - w) / 2;
        ctx.drawImage(image, x, y, w, h);
    }

    let scale = 1;

    canvas.addEventListener('wheel', () => {
        
      event.preventDefault();

      ctx.clearRect(0, 0, event.target.width, event.target.height);

      scale += event.deltaY * -0.001;

      scale = Math.min(Math.max(0.5, scale), 2);

      ctx.save();

      ctx.drawImage(
        image, 
        0, 
        0, 
        image.width, 
        image.height,
        event.clientX - w * scale / 2,
        event.clientY - h * scale / 2,
        w * scale, 
        h * scale);
      
      ctx.restore();

    }, false);
  </script>
</body>
</html>
